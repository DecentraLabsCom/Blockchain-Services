# =============================================================================
# Blockchain Services - Example Environment Configuration
# =============================================================================
# Copy this file to .env and configure your values
# This file is tracked in git, .env is not (contains secrets)

# -----------------------------------------------------------------------------
# SMART CONTRACT CONFIGURATION
# -----------------------------------------------------------------------------
CONTRACT_ADDRESS=0xYourDiamondContractAddress

# Legacy RPC URL (fallback if network-specific URLs not available)
RPC_URL=https://1rpc.io/sepolia

# -----------------------------------------------------------------------------
# NETWORK-SPECIFIC RPC URLs (with automatic failover)
# -----------------------------------------------------------------------------
# Format: comma-separated list of endpoints
# Service tries each URL in order until one succeeds
# Recommended: Mix free public endpoints with paid services for reliability
#
# Free providers with API keys:
# - Infura: https://infura.io (100k requests/day free)
# - Alchemy: https://alchemy.com (300M compute units/month free)
ETHEREUM_MAINNET_RPC_URL=https://eth.public-rpc.com
ETHEREUM_SEPOLIA_RPC_URL=https://1rpc.io/sepolia,https://rpc.sepolia.org,https://rpc2.sepolia.org,https://ethereum-sepolia-rpc.publicnode.com,https://eth-sepolia.g.alchemy.com/v2/demo

# -----------------------------------------------------------------------------
# INSTITUTIONAL WALLET
# -----------------------------------------------------------------------------
# Used for ALL automated transactions:
# - Event listener automatic confirmations/denials
# - Institutional reservations (treasury operations)
# - Administrative operations (treasury admin)
# 
# SETUP (one-time):
# 1. Start service: docker-compose up -d blockchain-services
# 2. Create wallet: docker exec blockchain-services curl -X POST http://localhost:8080/wallet/create \
#      -H "Content-Type: application/json" -d '{"password":"YourSecurePassword"}'
# 3. Copy the returned address
# 4. Configure these environment variables
# 5. Restart: docker-compose restart blockchain-services
#
# SECURITY:
# - Wallet private key is AES-256-GCM encrypted in /app/data/wallets.json
# - Only the password is in environment variables (rotatable)
# - Use AWS Secrets Manager / Azure Key Vault for production
INSTITUTIONAL_WALLET_ADDRESS=
INSTITUTIONAL_WALLET_PASSWORD=

# -----------------------------------------------------------------------------
# WALLET PERSISTENCE
# -----------------------------------------------------------------------------
WALLET_PERSISTENCE_ENABLED=true
WALLET_FILE_PATH=/app/data/wallets.json

# -----------------------------------------------------------------------------
# JWT KEY PATHS
# -----------------------------------------------------------------------------
# Keep defaults unless mounting keys from different location
PRIVATE_KEY_PATH=/app/config/keys/private_key.pem
PUBLIC_KEY_PATH=/app/config/keys/public_key.pem
PUBLIC_CERTIFICATE_PATH=/app/config/keys/certificate.pem

# -----------------------------------------------------------------------------
# SAML/SSO CONFIGURATION
# -----------------------------------------------------------------------------
# trust-mode: 
#   - 'any': Trust any IdP with valid SAML signature (flexible, less secure)
#   - 'whitelist': Only trust specific IdPs listed below (recommended for production)
SAML_IDP_TRUST_MODE=any

# Trusted IdP Issuers (only used if trust-mode=whitelist)
# Format: {'institutionId':'idpIssuerUrl', 'institutionId2':'idpIssuerUrl2'}
SAML_TRUSTED_IDP={'uned':'https://idp.uned.es','ucm':'https://idp.ucm.es'}

# -----------------------------------------------------------------------------
# FEATURE TOGGLES
# -----------------------------------------------------------------------------
# Enable Treasury and Provider management features
FEATURES_PROVIDERS_ENABLED=true

# -----------------------------------------------------------------------------
# ANTI-REPLAY PROTECTION
# -----------------------------------------------------------------------------
# For single instance: false (uses in-memory cache with 5 min expiration)
# For multiple instances: true (requires Redis for shared state)
ANTIREPLAY_PERSISTENCE_ENABLED=false

# -----------------------------------------------------------------------------
# SECURITY & API
# -----------------------------------------------------------------------------
ALLOWED_ORIGINS=http://localhost:3000,https://marketplace-decentralabs.vercel.app
MARKETPLACE_PUBLIC_KEY_URL=https://marketplace-decentralabs.vercel.app/.well-known/public-key.pem
LOG_LEVEL_AUTH=INFO
LOG_LEVEL_SECURITY=WARN
LOG_LEVEL_WEB=WARN

# -----------------------------------------------------------------------------
# SPRING BOOT / TOMCAT
# -----------------------------------------------------------------------------
TOMCAT_MAX_THREADS=200
TOMCAT_MIN_THREADS=10
JPA_DDL_AUTO=validate
JPA_SHOW_SQL=false
