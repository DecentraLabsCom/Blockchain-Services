# -----------------------------------------------------------------------------
# SMART CONTRACT CONFIGURATION
# -----------------------------------------------------------------------------
CONTRACT_ADDRESS=0x7189d48be3e0e3d86A783B50b4D9Cf5DaEb8815c
BLOCKCHAIN_NETWORK_ACTIVE=sepolia
ETHEREUM_GAS_PRICE_DEFAULT=
ETHEREUM_GAS_LIMIT_CONTRACT=300000

# -----------------------------------------------------------------------------
# NETWORK-SPECIFIC RPC URLs (with automatic failover)
# -----------------------------------------------------------------------------
# Format: comma-separated list - tries each endpoint in order
# Service tries each URL in order until one succeeds
# Recommended: Mix free public endpoints or use paid services for reliability
#
# Free providers with API keys:
# - Infura: https://infura.io (100k requests/day free)
# - Alchemy: https://alchemy.com (300M compute units/month free)
ETHEREUM_MAINNET_RPC_URL=https://eth.public-rpc.com
ETHEREUM_SEPOLIA_RPC_URL=https://ethereum-sepolia-rpc.publicnode.com,https://0xrpc.io/sep,https://ethereum-sepolia-public.nodies.app

# -----------------------------------------------------------------------------
# CONTRACT EVENT LISTENING
# -----------------------------------------------------------------------------
CONTRACT_EVENT_POLLING_ENABLED=true
CONTRACT_EVENT_POLLING_INTERVAL=60
CONTRACT_EVENT_POLLING_BLOCK_RANGE=1000
CONTRACT_EVENT_POLLING_LOOKBACK=100

# -----------------------------------------------------------------------------
# INSTITUTIONAL WALLET (optional overrides)
# -----------------------------------------------------------------------------
# Normally you create/import the institutional wallet via /wallet-dashboard.
# The app then stores the encrypted key in /app/data/wallets.json and writes
# address/password to /app/data/wallet-config.properties. Leave these empty to
# rely on that auto-configuration. Only set them if you need to override with
# external secret management (env vars take precedence over the config file).
INSTITUTIONAL_WALLET_ADDRESS=
INSTITUTIONAL_WALLET_PASSWORD=
WALLET_ADDRESS=0x0000000000000000000000000000000000000000

# -----------------------------------------------------------------------------
# WALLET PERSISTENCE
# -----------------------------------------------------------------------------
WALLET_PERSISTENCE_ENABLED=true
WALLET_FILE_PATH=/app/data/wallets.json

# REQUIRED for wallet persistence: Encryption key for wallet password storage
# Leave empty to let the service auto-generate it into WALLET_CONFIG_KEY_FILE
WALLET_CONFIG_ENCRYPTION_KEY=
# Persistent file that stores the auto-generated encryption key (must be mounted)
WALLET_CONFIG_KEY_FILE=/app/data/.wallet-encryption-key

# -----------------------------------------------------------------------------
# DATABASE (optional; required for persistence features)
# -----------------------------------------------------------------------------
# Example: jdbc:mysql://mysql:3306/guacamole_db?serverTimezone=UTC&characterEncoding=UTF-8&useSSL=false
BCHAIN_MYSQL_ROOT_PASSWORD=change-me
BCHAIN_MYSQL_DATABASE=blockchain_services
BCHAIN_MYSQL_USER=blockchain
BCHAIN_MYSQL_PASSWORD=blockchain

# -----------------------------------------------------------------------------
# JWT KEY PATHS
# -----------------------------------------------------------------------------
# Keep defaults unless mounting keys from different location
PRIVATE_KEY_PATH=/app/config/keys/private_key.pem
PUBLIC_KEY_PATH=/app/config/keys/public_key.pem

# -----------------------------------------------------------------------------
# SAML/SSO CONFIGURATION
# -----------------------------------------------------------------------------
SAML_IDP_METADATA_OVERRIDE={"https://fpp.sir2.rediris.es/es.rediris.sir2.test.validacion/idp":"https://fpp.sir2.rediris.es/es.rediris.sir2.test.validacion/saml2/idp/metadata.php"}

# trust-mode:
#   - 'any': Trust any IdP with valid SAML signature (flexible, less secure)
#   - 'whitelist': Only trust specific IdPs listed below (recommended for production)
SAML_IDP_TRUST_MODE=any
SAML_METADATA_ALLOW_HTTP=false
# Trusted IdP Issuers (only used if trust-mode=whitelist)
# Format: {'institutionId':'idpIssuerUrl', 'institutionId2':'idpIssuerUrl2'}
SAML_TRUSTED_IDP={'uned':'https://idp.uned.es','ucm':'https://idp.ucm.es'}

# -----------------------------------------------------------------------------
# WEBAUTHN CONFIGURATION
# -----------------------------------------------------------------------------
WEBAUTHN_CREDENTIALS_TABLE=webauthn_credentials
WEBAUTHN_CREDENTIALS_MAX_AGE_DAYS=365
WEBAUTHN_CREDENTIALS_REVOKE_INTERVAL_MS=86400000
WEBAUTHN_RP_NAME=DecentraLabs Gateway
WEBAUTHN_RP_ORIGINS=https://localhost,https://localhost:443,https://localhost:8443
WEBAUTHN_TIMEOUT_MS=120000
WEBAUTHN_SESSION_TTL_SECONDS=300
WEBAUTHN_SESSION_CLEANUP_INTERVAL_SECONDS=60
WEBAUTHN_ATTESTATION_CONVEYANCE=none
WEBAUTHN_AUTHENTICATOR_ATTACHMENT=
WEBAUTHN_RESIDENT_KEY=preferred
WEBAUTHN_USER_VERIFICATION=preferred

# -----------------------------------------------------------------------------
# FEATURE TOGGLES
# -----------------------------------------------------------------------------
# Enable Treasury and Provider management features
FEATURES_PROVIDERS_ENABLED=false
FEATURES_ORGANIZATIONS_ENABLED=true
FEATURES_AUTO_PROVIDER_REGISTRATION_ENABLED=false
FEATURES_PROVIDERS_REGISTRATION_ENABLED=false

# -----------------------------------------------------------------------------
# ORGANIZATION INVITES
# -----------------------------------------------------------------------------
ORGANIZATION_INVITE_HMAC_SECRET=
ORGANIZATION_INVITE_DEFAULT_ISSUER=DecentraLabs Marketplace

# -----------------------------------------------------------------------------
# ANTI-REPLAY PROTECTION
# -----------------------------------------------------------------------------
# For single instance: false (uses in-memory cache with 5 min expiration)
# For multiple instances: true (requires Redis)
ANTIREPLAY_PERSISTENCE_ENABLED=false

# -----------------------------------------------------------------------------
# INTENTS CONFIGURATION
# -----------------------------------------------------------------------------
INTENT_TRUSTED_SIGNER=
INTENT_DEFAULT_ETA=15s
INTENT_DOMAIN_NAME=DecentraLabsIntent
INTENT_DOMAIN_VERSION=1
INTENT_DOMAIN_CHAIN_ID=11155111
INTENT_DOMAIN_VERIFYING_CONTRACT=0x7189d48be3e0e3d86A783B50b4D9Cf5DaEb8815c
INTENT_RECONCILIATION_INTERVAL_MS=10000
INTENT_EXECUTION_INTERVAL_MS=5000
INTENT_WEBHOOK_URL=
INTENT_WEBHOOK_SECRET=
INTENTS_AUTH_ENABLED=true
INTENTS_AUTH_ISSUER=marketplace
INTENTS_AUTH_AUDIENCE=blockchain-services
INTENTS_AUTH_SUBMIT_SCOPE=intents:submit
INTENTS_AUTH_STATUS_SCOPE=intents:status
INTENTS_AUTH_CLOCK_SKEW_SECONDS=60

# -----------------------------------------------------------------------------
# SECURITY & API
# -----------------------------------------------------------------------------
BASE_DOMAIN=
ALLOWED_ORIGINS=http://localhost:3000,https://marketplace-decentralabs.vercel.app
MARKETPLACE_PUBLIC_KEY_URL=https://marketplace-decentralabs.vercel.app/.well-known/public-key.pem
MARKETPLACE_URL=https://marketplace-decentralabs.vercel.app
LOG_LEVEL_AUTH=INFO
LOG_LEVEL_SECURITY=WARN
LOG_LEVEL_WEB=WARN
LOG_LEVEL_ROOT=INFO

# -----------------------------------------------------------------------------
# MARKETPLACE AUTO-REGISTRATION
# -----------------------------------------------------------------------------
MARKETPLACE_BASE_URL=
PROVIDER_NAME=
PROVIDER_EMAIL=
PROVIDER_COUNTRY=
PROVIDER_ORGANIZATION=
PUBLIC_BASE_URL=

# -----------------------------------------------------------------------------
# ADMIN DASHBOARD ACCESS
# -----------------------------------------------------------------------------
# Allows you to disable localhost-only protection for the treasury dashboard.
# Set to false when running standalone (default for docker-compose.override).
# Leave unset/true when the service sits behind a reverse proxy (OpenResty).
# Restrict treasury admin endpoints to localhost/private networks.
# If running behind a reverse proxy, keep this enabled and configure
# BCHAIN_SECURITY_ALLOW_PRIVATE_NETWORKS + BCHAIN_SECURITY_ACCESS_TOKEN.
BCHAIN_ADMIN_DASHBOARD_LOCAL_ONLY=true
BCHAIN_ADMIN_DASHBOARD_ALLOW_PRIVATE=false

# Allow private network access (docker bridge) for remote access endpoints.
# When enabled, SECURITY_ACCESS_TOKEN is required.
BCHAIN_SECURITY_ALLOW_PRIVATE_NETWORKS=true
BCHAIN_SECURITY_ACCESS_TOKEN=
BCHAIN_SECURITY_ACCESS_TOKEN_HEADER=X-Access-Token
BCHAIN_SECURITY_ACCESS_TOKEN_COOKIE=access_token
BCHAIN_SECURITY_ACCESS_TOKEN_REQUIRED=false

# -----------------------------------------------------------------------------
# SPRING BOOT / TOMCAT
# -----------------------------------------------------------------------------
SPRING_PROFILES_ACTIVE=default
TOMCAT_MAX_THREADS=200
TOMCAT_MIN_THREADS=10
JPA_DDL_AUTO=validate
JPA_SHOW_SQL=false

# -----------------------------------------------------------------------------
# BOOKINGS NOTIFICATIONS (email + ICS)
# -----------------------------------------------------------------------------
NOTIFICATIONS_MAIL_ENABLED=true
NOTIFICATIONS_MAIL_DRIVER=noop
NOTIFICATIONS_MAIL_FROM=
NOTIFICATIONS_MAIL_FROM_NAME=Lab Gateway
NOTIFICATIONS_MAIL_DEFAULT_TO=
NOTIFICATIONS_MAIL_TIMEZONE=UTC

# SMTP (driver=smtp)
NOTIFICATIONS_MAIL_SMTP_HOST=
NOTIFICATIONS_MAIL_SMTP_PORT=587
NOTIFICATIONS_MAIL_SMTP_USERNAME=
NOTIFICATIONS_MAIL_SMTP_PASSWORD=
NOTIFICATIONS_MAIL_SMTP_AUTH=true
NOTIFICATIONS_MAIL_SMTP_STARTTLS=true
NOTIFICATIONS_MAIL_SMTP_TIMEOUT_MS=10000

# Microsoft Graph (driver=graph)
NOTIFICATIONS_MAIL_GRAPH_TENANT_ID=
NOTIFICATIONS_MAIL_GRAPH_CLIENT_ID=
NOTIFICATIONS_MAIL_GRAPH_CLIENT_SECRET=
NOTIFICATIONS_MAIL_GRAPH_FROM=
NOTIFICATIONS_CONFIG_FILE=./data/notifications-config.json

# SECURITY
MYSQL_ROOT_PASSWORD=
MYSQL_PASSWORD=
SECURITY_ACCESS_TOKEN=
SECURITY_ACCESS_TOKEN_HEADER=X-Access-Token
SECURITY_ACCESS_TOKEN_COOKIE=access_token
SECURITY_ACCESS_TOKEN_REQUIRED=true
SECURITY_ALLOW_PRIVATE_NETWORKS=true
ADMIN_DASHBOARD_ALLOW_PRIVATE=true
